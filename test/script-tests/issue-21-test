#!/bin/bash

# Test for GitHub issue #21.
# See: https://github.com/allenh1/YaSh/issues/21

# this is the command that broke it.
cd_cmd="cd .././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/./././././././././././././././././././././././././././././././././././././././././././././.././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/./././././././././././././././././././././././././././././././././././././././././././././.././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/./././././././././././././././././././././././././././././././././././././././././././././.././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/./././././././././././././././././././././././././././././././././././././././././././././"

echo "cd ../../../../" > simple_cd
echo "pwd" >> simple_cd

echo ${cd_cmd} > shane_cd
echo "pwd" >> shane_cd

${SHELL_BIN} < simple_cd &>> simple_out
${SHELL_BIN} < shane_cd &>> shane_out

diff simple_out shane_out

if [[ $? -ne 0 ]]; then
    echo "Issue #21 regression test failed"
    rm -f simple_out shane_out simple_cd shane_cd
    exit 1
fi

echo "Issue 21 test OK"
rm -f simple_out shane_out simple_cd shane_cd
exit 0
